api_base_url = "https://cve.circl.lu/api/cve/"



class CVEDetailsFetcher{
    constructor(){
        this.cache = CVELocalStorageCache()
    }

    get(cve_id, callback){
        this.cache.get(cve_id, (result)=>{
            if(!result){
                api_handler.get(cve_id, callback)
            }else callback(result)
        })
    }
}

class CVELocalStorageCache{
    constructor(){}
    
    get(cve_id, callback){
        chrome.storage.sync.get([cve_id], (result)=>{
            callback(result)
        })
    }

    set(cve_id,value){
        chrome.storage.sync.set({cve_id: value}, ()=>{})
    }
}

class CVEApiHandler{
    constructor(api_base_url){
        this.cache = CVELocalStorageCache()
        this.base_url = api_base_url
    }
    
    get(cve_id, callback){
        fetch(this.base_url + cve_id)
            .then(response=>response.json())
            .then(response=>{callback(response)})
    }
}


f = CVEDetailsFetcher()

f.get("CVE-2019-10008")